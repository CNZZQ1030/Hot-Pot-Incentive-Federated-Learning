# Federated Learning with Differentiated Model Rewards
# åŸºäºå·®å¼‚åŒ–æ¨¡å‹å¥–åŠ±çš„è”é‚¦å­¦ä¹ æ¿€åŠ±æœºåˆ¶

## ğŸ“‹ ç›®å½• / Table of Contents

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°--project-overview)
2. [æ ¸å¿ƒåˆ›æ–°](#æ ¸å¿ƒåˆ›æ–°--core-innovation)
3. [å®éªŒè®¾è®¡æ€è·¯](#å®éªŒè®¾è®¡æ€è·¯--experiment-design)
4. [å®‰è£…è¯´æ˜](#å®‰è£…è¯´æ˜--installation)
5. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹--quick-start)
6. [å®éªŒæ‰§è¡Œæµç¨‹](#å®éªŒæ‰§è¡Œæµç¨‹--experiment-workflow)
7. [å‘½ä»¤è¡Œå‚æ•°](#å‘½ä»¤è¡Œå‚æ•°--command-line-arguments)
8. [å®éªŒç»“æœåˆ†æ](#å®éªŒç»“æœåˆ†æ--results-analysis)
9. [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„--project-structure)
10. [æ‰©å±•ä¸å®šåˆ¶](#æ‰©å±•ä¸å®šåˆ¶--customization)

---

## é¡¹ç›®æ¦‚è¿° / Project Overview

æœ¬é¡¹ç›®å®ç°äº†ä¸€ä¸ª**åˆ›æ–°çš„è”é‚¦å­¦ä¹ æ¿€åŠ±æœºåˆ¶**ï¼Œçµæ„Ÿæ¥æºäºå•†ä¸šä¼šå‘˜ç³»ç»Ÿï¼ˆç‰¹åˆ«æ˜¯æµ·åº•æç«é”…é¤å…çš„ä¼šå‘˜æ¨¡å¼ï¼‰ã€‚æ ¸å¿ƒåˆ›æ–°æ˜¯**å·®å¼‚åŒ–æ¨¡å‹å¥–åŠ±æœºåˆ¶**ï¼šä¸åŒç­‰çº§çš„å®¢æˆ·ç«¯æ ¹æ®å…¶è´¡çŒ®è·å¾—ä¸åŒè´¨é‡çš„å…¨å±€æ¨¡å‹ï¼Œå½¢æˆ"è´¡çŒ®è¶Šå¤§ï¼Œæ¨¡å‹è¶Šå¥½"çš„æ­£å‘æ¿€åŠ±å¾ªç¯ã€‚

This project implements an **innovative federated learning incentive mechanism** inspired by commercial membership systems (specifically Haidilao's hotpot restaurant membership model). The core innovation is a **differentiated model reward mechanism**: clients of different levels receive global models of varying quality based on their contributions, creating a positive incentive cycle of "greater contribution leads to better models."

### ä¸»è¦ç‰¹ç‚¹ / Key Features

âœ… **å·®å¼‚åŒ–æ¨¡å‹å¥–åŠ±** - é«˜ç­‰çº§å®¢æˆ·ç«¯è·å¾—æ›´ä¼˜è´¨çš„èšåˆæ¨¡å‹  
âœ… **ä¼šå‘˜ç­‰çº§ç³»ç»Ÿ** - é“œã€é“¶ã€é‡‘ã€é’»çŸ³å››çº§ä½“ç³»  
âœ… **æ—¶é—´ç‰‡ç§¯åˆ†ç®¡ç†** - 5ç§æ—¶é—´ç‰‡ç­–ç•¥ï¼Œç§¯åˆ†æœ‰æ•ˆæœŸæœºåˆ¶  
âœ… **å…¬å¹³æ€§ä¿éšœ** - åŸºäºæ•°æ®é‡ã€è®¡ç®—æ—¶é—´å’Œæ¨¡å‹è´¨é‡çš„å¤šç»´åº¦è¯„ä¼°  
âœ… **å®Œæ•´å¯è§†åŒ–** - è®­ç»ƒæ›²çº¿ã€ç­‰çº§åˆ†å¸ƒã€è´¨é‡å·®è·ç­‰å¤šç»´åº¦åˆ†æ  

---

## æ ¸å¿ƒåˆ›æ–° / Core Innovation

### ğŸ¯ å·®å¼‚åŒ–æ¨¡å‹å¥–åŠ±æœºåˆ¶

ä¼ ç»Ÿè”é‚¦å­¦ä¹ ä¸­ï¼Œæ‰€æœ‰å®¢æˆ·ç«¯åœ¨æ¯è½®è®­ç»ƒåéƒ½æ¥æ”¶ç›¸åŒçš„å…¨å±€æ¨¡å‹ã€‚æœ¬é¡¹ç›®åˆ›æ–°æ€§åœ°å¼•å…¥**åˆ†å±‚æ¨¡å‹åˆ†å‘ç­–ç•¥**ï¼š

```
æœåŠ¡å™¨èšåˆé˜¶æ®µï¼š
â”œâ”€â”€ æ”¶é›†æ‰€æœ‰å®¢æˆ·ç«¯çš„æ¨¡å‹æ›´æ–°
â”œâ”€â”€ åˆ›å»ºæ ‡å‡†å…¨å±€æ¨¡å‹ï¼ˆFedAvgï¼‰
â””â”€â”€ æ ¹æ®å®¢æˆ·ç«¯ç­‰çº§åˆ›å»ºå·®å¼‚åŒ–æ¨¡å‹ï¼š
    â”œâ”€â”€ é’»çŸ³çº§æ¨¡å‹ï¼šä½¿ç”¨é«˜è´¨é‡å®¢æˆ·ç«¯ï¼Œæƒé‡Ã—3.0
    â”œâ”€â”€ é‡‘çº§æ¨¡å‹ï¼šä½¿ç”¨ä¼˜è´¨å®¢æˆ·ç«¯ï¼Œæƒé‡Ã—2.0  
    â”œâ”€â”€ é“¶çº§æ¨¡å‹ï¼šæ ‡å‡†æƒé‡èšåˆ
    â””â”€â”€ é“œçº§æ¨¡å‹ï¼šåŸºç¡€å…¨å±€æ¨¡å‹

å®¢æˆ·ç«¯è®­ç»ƒé˜¶æ®µï¼š
â”œâ”€â”€ é’»çŸ³çº§å®¢æˆ·ç«¯ â†’ æ¥æ”¶é’»çŸ³çº§æ¨¡å‹ï¼ˆæœ€ä¼˜ï¼‰
â”œâ”€â”€ é‡‘çº§å®¢æˆ·ç«¯ â†’ æ¥æ”¶é‡‘çº§æ¨¡å‹ï¼ˆä¼˜è´¨ï¼‰
â”œâ”€â”€ é“¶çº§å®¢æˆ·ç«¯ â†’ æ¥æ”¶é“¶çº§æ¨¡å‹ï¼ˆæ ‡å‡†ï¼‰
â””â”€â”€ é“œçº§å®¢æˆ·ç«¯ â†’ æ¥æ”¶é“œçº§æ¨¡å‹ï¼ˆåŸºç¡€ï¼‰
```

### ğŸ’¡ æ¿€åŠ±åŸç†

1. **æ­£å‘å¾ªç¯**ï¼šå®¢æˆ·ç«¯è´¡çŒ®æ›´å¤š â†’ ç§¯åˆ†å¢åŠ  â†’ ç­‰çº§æå‡ â†’ è·å¾—æ›´å¥½æ¨¡å‹ â†’ è®­ç»ƒæ•ˆæœæå‡ â†’ æ›´æ„¿æ„è´¡çŒ®
2. **å…¬å¹³æ€§**ï¼šè´¡çŒ®ä¸å›æŠ¥åŒ¹é…ï¼Œé¿å…"æ­ä¾¿è½¦"é—®é¢˜
3. **å¯æŒç»­æ€§**ï¼šç§¯åˆ†æœ‰æ•ˆæœŸæœºåˆ¶é¼“åŠ±æŒç»­å‚ä¸

---

## å®éªŒè®¾è®¡æ€è·¯ / Experiment Design

### ğŸ“Š å®éªŒç›®æ ‡

éªŒè¯å·®å¼‚åŒ–æ¨¡å‹å¥–åŠ±æœºåˆ¶èƒ½å¤Ÿï¼š
1. **æé«˜ç³»ç»Ÿæ•´ä½“æ€§èƒ½** - ç›¸æ¯”æ ‡å‡†æ¿€åŠ±æœºåˆ¶ï¼Œå…¨å±€æ¨¡å‹å‡†ç¡®ç‡æ›´é«˜
2. **å¢å¼ºå®¢æˆ·ç«¯å‚ä¸åº¦** - é«˜ç­‰çº§å®¢æˆ·ç«¯å‚ä¸ç‡å’Œæ´»è·ƒåº¦æå‡
3. **åŠ å¿«æ¨¡å‹æ”¶æ•›é€Ÿåº¦** - è¾¾åˆ°ç›®æ ‡å‡†ç¡®ç‡æ‰€éœ€è½®æ¬¡å‡å°‘
4. **å½¢æˆæ˜æ˜¾çš„è´¨é‡å·®å¼‚** - ä¸åŒç­‰çº§æ¨¡å‹ä¹‹é—´å­˜åœ¨å¯è§‚æµ‹çš„æ€§èƒ½å·®è·

### ğŸ”¬ å®éªŒè®¾ç½®

#### åŸºç¡€é…ç½®
- **å®¢æˆ·ç«¯æ•°é‡**ï¼š100ä¸ª
- **æ¯è½®é€‰æ‹©**ï¼š10ä¸ªå®¢æˆ·ç«¯
- **è®­ç»ƒè½®æ¬¡**ï¼š100è½®
- **æœ¬åœ°è®­ç»ƒ**ï¼š5ä¸ªepochs
- **æ•°æ®é›†**ï¼šCIFAR-10, MNIST, Fashion-MNIST

#### ä¼šå‘˜ç­‰çº§è®¾ç½®
| ç­‰çº§ | ç§¯åˆ†é˜ˆå€¼ | æƒç›Šå€æ•° | æ¨¡å‹è´¨é‡æœŸæœ› |
|------|---------|---------|-------------|
| é’»çŸ³ (Diamond) | 15,000+ | 2.0Ã— | æœ€ä¼˜ (100%) |
| é‡‘ (Gold) | 6,000+ | 1.5Ã— | ä¼˜è´¨ (75%) |
| é“¶ (Silver) | 2,000+ | 1.2Ã— | æ ‡å‡† (50%) |
| é“œ (Bronze) | 0+ | 1.0Ã— | åŸºç¡€ (30%) |

#### å·®å¼‚åŒ–èšåˆç­–ç•¥

**åŠ æƒç­–ç•¥ (Weighted)** - æ¨èä½¿ç”¨ï¼š
```python
é’»çŸ³çº§æ¨¡å‹æƒé‡åˆ†é…ï¼š
- é’»çŸ³çº§å®¢æˆ·ç«¯ï¼š3.0Ã—
- é‡‘çº§å®¢æˆ·ç«¯ï¼š2.0Ã—
- é“¶çº§å®¢æˆ·ç«¯ï¼š1.0Ã—
- é“œçº§å®¢æˆ·ç«¯ï¼š0.5Ã—
```

**ä¸¥æ ¼ç­–ç•¥ (Strict)**ï¼š
- é’»çŸ³çº§æ¨¡å‹ï¼šä»…ä½¿ç”¨é’»çŸ³+é‡‘çº§å®¢æˆ·ç«¯
- é‡‘çº§æ¨¡å‹ï¼šä½¿ç”¨é’»çŸ³+é‡‘+é“¶çº§å®¢æˆ·ç«¯
- é“¶/é“œçº§æ¨¡å‹ï¼šä½¿ç”¨å…¨å±€æ¨¡å‹

### ğŸ“ˆ è¯„ä¼°æŒ‡æ ‡

1. **æ¨¡å‹æ€§èƒ½æŒ‡æ ‡**
   - å…¨å±€æ¨¡å‹å‡†ç¡®ç‡å’ŒæŸå¤±
   - å„ç­‰çº§æ¨¡å‹å‡†ç¡®ç‡
   - æ”¶æ•›é€Ÿåº¦ï¼ˆè¾¾åˆ°95%æœ€ä¼˜æ€§èƒ½çš„è½®æ¬¡ï¼‰

2. **æ¿€åŠ±æ•ˆæœæŒ‡æ ‡**
   - å®¢æˆ·ç«¯å‚ä¸ç‡
   - ç³»ç»Ÿæ´»è·ƒåº¦
   - ä¼šå‘˜ç­‰çº§åˆ†å¸ƒæ¼”å˜

3. **å·®å¼‚åŒ–æ•ˆæœæŒ‡æ ‡**
   - è´¨é‡å·®è·ï¼ˆé’»çŸ³çº§-é“œçº§å‡†ç¡®ç‡å·®ï¼‰
   - ç­‰çº§æå‡é€Ÿç‡
   - é«˜ç­‰çº§å®¢æˆ·ç«¯ç•™å­˜ç‡

---

## å®‰è£…è¯´æ˜ / Installation

### ç¯å¢ƒè¦æ±‚

- Python 3.7+
- PyTorch 1.9+
- CUDA (å¯é€‰ï¼Œç”¨äºGPUåŠ é€Ÿ)

### å®‰è£…æ­¥éª¤

1. **å…‹éš†ä»“åº“** / Clone repository:
```bash
git clone <repository_url>
cd federated_learning_incentive
```

2. **å®‰è£…ä¾èµ–** / Install dependencies:
```bash
pip install -r requirements.txt
```

3. **éªŒè¯å®‰è£…** / Verify installation:
```bash
python -c "import torch; print(f'PyTorch version: {torch.__version__}')"
python -c "import torchvision; print('Installation successful!')"
```

---

## å¿«é€Ÿå¼€å§‹ / Quick Start

### ğŸš€ è¿è¡Œç¬¬ä¸€ä¸ªå®éªŒ

**å®éªŒ1ï¼šæ ‡å‡†æ¿€åŠ±æœºåˆ¶ï¼ˆåŸºçº¿ï¼‰**
```bash
python main.py \
    --dataset cifar10 \
    --num_clients 100 \
    --num_rounds 100 \
    --distribution iid \
    --experiment_name baseline_standard
```

**å®éªŒ2ï¼šå·®å¼‚åŒ–æ¨¡å‹å¥–åŠ±æœºåˆ¶**
```bash
python main.py \
    --dataset cifar10 \
    --num_clients 100 \
    --num_rounds 100 \
    --distribution iid \
    --enable_tiered_rewards \
    --experiment_name baseline_tiered
```

**å®éªŒ3ï¼šè‡ªåŠ¨å¯¹æ¯”ä¸¤ç§æœºåˆ¶**
```bash
python main.py \
    --dataset cifar10 \
    --num_clients 100 \
    --num_rounds 100 \
    --compare_rewards
```

### ğŸ“Š æŸ¥çœ‹ç»“æœ

å®éªŒå®Œæˆåï¼Œç»“æœä¿å­˜åœ¨ä»¥ä¸‹ä½ç½®ï¼š

```
outputs/
â”œâ”€â”€ results/
â”‚   â”œâ”€â”€ {experiment_name}_results.json      # è¯¦ç»†å®éªŒæ•°æ®
â”‚   â””â”€â”€ plots/
â”‚       â”œâ”€â”€ {experiment_name}_training_curves.png      # è®­ç»ƒæ›²çº¿
â”‚       â”œâ”€â”€ {experiment_name}_level_distribution.png   # ç­‰çº§åˆ†å¸ƒ
â”‚       â”œâ”€â”€ {experiment_name}_points_distribution.png  # ç§¯åˆ†åˆ†å¸ƒ
â”‚       â””â”€â”€ {experiment_name}_summary_report.png       # æ€»ç»“æŠ¥å‘Š
â”œâ”€â”€ checkpoints/
â”‚   â””â”€â”€ {experiment_name}_round_*.pt        # æ¨¡å‹æ£€æŸ¥ç‚¹
â””â”€â”€ logs/
    â””â”€â”€ experiment.log                       # è¿è¡Œæ—¥å¿—
```

---

## å®éªŒæ‰§è¡Œæµç¨‹ / Experiment Workflow

### å®Œæ•´å®éªŒæµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. åˆå§‹åŒ–é˜¶æ®µ / Initialization Phase                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ åŠ è½½æ•°æ®é›†å¹¶åˆ†é…ç»™å„å®¢æˆ·ç«¯                               â”‚
â”‚ â€¢ åˆå§‹åŒ–å…¨å±€æ¨¡å‹                                          â”‚
â”‚ â€¢ åˆ›å»ºä¼šå‘˜ç³»ç»Ÿï¼ˆæ‰€æœ‰å®¢æˆ·ç«¯åˆå§‹ä¸ºé“œçº§ï¼‰                      â”‚
â”‚ â€¢ è®¾ç½®æ—¶é—´ç‰‡ç®¡ç†å™¨å’Œç§¯åˆ†è®¡ç®—å™¨                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. è®­ç»ƒå¾ªç¯ (é‡å¤100è½®) / Training Loop (100 rounds)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
  â”œâ”€â†’ 2.1 å®¢æˆ·ç«¯é€‰æ‹© / Client Selection
  â”‚   â”œâ”€ è·å–æ‰€æœ‰å®¢æˆ·ç«¯çš„ä¼šå‘˜ç­‰çº§å’Œç§¯åˆ†
  â”‚   â”œâ”€ è®¡ç®—ä¼˜å…ˆçº§ï¼ˆé«˜ç­‰çº§å®¢æˆ·ç«¯æœ‰ä¼˜å…ˆé€‰æ‹©æƒï¼‰
  â”‚   â””â”€ é€‰æ‹©10ä¸ªå®¢æˆ·ç«¯å‚ä¸æœ¬è½®è®­ç»ƒ
  â”‚
  â”œâ”€â†’ 2.2 æ¨¡å‹åˆ†å‘ / Model Distribution
  â”‚   â”œâ”€ å¦‚æœå¯ç”¨å·®å¼‚åŒ–å¥–åŠ±ï¼š
  â”‚   â”‚   â”œâ”€ é’»çŸ³çº§å®¢æˆ·ç«¯ â†’ è·å–é’»çŸ³çº§æ¨¡å‹
  â”‚   â”‚   â”œâ”€ é‡‘çº§å®¢æˆ·ç«¯ â†’ è·å–é‡‘çº§æ¨¡å‹
  â”‚   â”‚   â”œâ”€ é“¶çº§å®¢æˆ·ç«¯ â†’ è·å–é“¶çº§æ¨¡å‹
  â”‚   â”‚   â””â”€ é“œçº§å®¢æˆ·ç«¯ â†’ è·å–é“œçº§æ¨¡å‹
  â”‚   â””â”€ å¦åˆ™ï¼šæ‰€æœ‰å®¢æˆ·ç«¯è·å–ç›¸åŒçš„å…¨å±€æ¨¡å‹
  â”‚
  â”œâ”€â†’ 2.3 æœ¬åœ°è®­ç»ƒ / Local Training
  â”‚   â”œâ”€ æ¯ä¸ªå®¢æˆ·ç«¯åœ¨æœ¬åœ°æ•°æ®ä¸Šè®­ç»ƒ5ä¸ªepochs
  â”‚   â”œâ”€ è®°å½•è®­ç»ƒæ—¶é—´ã€æŸå¤±ã€å‡†ç¡®ç‡
  â”‚   â””â”€ è®¡ç®—æ¨¡å‹è´¨é‡ = 1/(1+loss)
  â”‚
  â”œâ”€â†’ 2.4 ç§¯åˆ†è®¡ç®— / Points Calculation
  â”‚   â”œâ”€ åŸºç¡€ç§¯åˆ† = 0.3Ã—æ•°æ®é‡ + 0.3Ã—è®¡ç®—æ—¶é—´ + 0.4Ã—æ¨¡å‹è´¨é‡
  â”‚   â”œâ”€ åº”ç”¨ç­‰çº§å€æ•°ï¼ˆé’»çŸ³2.0Ã—ï¼Œé‡‘1.5Ã—ï¼Œé“¶1.2Ã—ï¼Œé“œ1.0Ã—ï¼‰
  â”‚   â””â”€ æ›´æ–°æ—¶é—´ç‰‡ç§¯åˆ†
  â”‚
  â”œâ”€â†’ 2.5 ç­‰çº§æ›´æ–° / Level Update
  â”‚   â”œâ”€ è®¡ç®—æœ‰æ•ˆç§¯åˆ†ï¼ˆæœ€è¿‘10ä¸ªæ—¶é—´ç‰‡å†…çš„ç§¯åˆ†ï¼‰
  â”‚   â”œâ”€ æ ¹æ®ç§¯åˆ†é˜ˆå€¼ç¡®å®šæ–°ç­‰çº§
  â”‚   â””â”€ è®°å½•ç­‰çº§å˜åŒ–å†å²
  â”‚
  â”œâ”€â†’ 2.6 æ¨¡å‹èšåˆ / Model Aggregation
  â”‚   â”œâ”€ æ ‡å‡†èšåˆï¼šåˆ›å»ºå…¨å±€æ¨¡å‹ï¼ˆFedAvgæˆ–åŠ æƒï¼‰
  â”‚   â””â”€ å¦‚æœå¯ç”¨å·®å¼‚åŒ–å¥–åŠ±ï¼š
  â”‚       â”œâ”€ åˆ›å»ºé’»çŸ³çº§æ¨¡å‹ï¼ˆé«˜è´¨é‡å®¢æˆ·ç«¯æƒé‡Ã—3.0ï¼‰
  â”‚       â”œâ”€ åˆ›å»ºé‡‘çº§æ¨¡å‹ï¼ˆä¼˜è´¨å®¢æˆ·ç«¯æƒé‡Ã—2.0ï¼‰
  â”‚       â”œâ”€ åˆ›å»ºé“¶çº§æ¨¡å‹ï¼ˆæ ‡å‡†æƒé‡ï¼‰
  â”‚       â””â”€ åˆ›å»ºé“œçº§æ¨¡å‹ï¼ˆåŸºç¡€å…¨å±€æ¨¡å‹ï¼‰
  â”‚
  â”œâ”€â†’ 2.7 æ¨¡å‹è¯„ä¼° / Model Evaluation
  â”‚   â”œâ”€ åœ¨æµ‹è¯•é›†ä¸Šè¯„ä¼°å…¨å±€æ¨¡å‹
  â”‚   â”œâ”€ å¦‚æœå¯ç”¨å·®å¼‚åŒ–å¥–åŠ±ï¼šè¯„ä¼°å„ç­‰çº§æ¨¡å‹
  â”‚   â”œâ”€ è®¡ç®—è´¨é‡å·®è·ï¼ˆé’»çŸ³çº§-é“œçº§ï¼‰
  â”‚   â””â”€ è®°å½•æ‰€æœ‰æ€§èƒ½æŒ‡æ ‡
  â”‚
  â””â”€â†’ 2.8 æŒ‡æ ‡æ›´æ–° / Metrics Update
      â”œâ”€ æ›´æ–°å‚ä¸ç‡ã€ç³»ç»Ÿæ´»è·ƒåº¦
      â”œâ”€ è®°å½•ä¼šå‘˜ç­‰çº§åˆ†å¸ƒ
      â””â”€ æ¸…ç†è¿‡æœŸç§¯åˆ†ï¼ˆæ¯10è½®ï¼‰
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. ç»“æœåˆ†æé˜¶æ®µ / Results Analysis Phase                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ ç”Ÿæˆè®­ç»ƒæ›²çº¿å›¾                                          â”‚
â”‚ â€¢ ç»˜åˆ¶ç­‰çº§åˆ†å¸ƒæ¼”å˜å›¾                                       â”‚
â”‚ â€¢ åˆ†æè´¨é‡å·®è·è¶‹åŠ¿                                        â”‚
â”‚ â€¢ åˆ›å»ºæ€»ç»“æŠ¥å‘Š                                            â”‚
â”‚ â€¢ ä¿å­˜æ¨¡å‹æ£€æŸ¥ç‚¹å’Œå®éªŒæ•°æ®                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å…³é”®æµç¨‹è¯´æ˜

#### ğŸ”‘ å·®å¼‚åŒ–æ¨¡å‹åˆ›å»ºæµç¨‹

```python
# ä¼ªä»£ç ç¤ºä¾‹
def create_tiered_models(client_weights, client_infos):
    """
    åˆ›å»ºåˆ†å±‚æ¨¡å‹çš„æ ¸å¿ƒé€»è¾‘
    """
    # 1. æŒ‰ç­‰çº§åˆ†ç»„å®¢æˆ·ç«¯
    diamond_clients = [id for id, info in client_infos.items() 
                      if info['level'] == 'diamond']
    gold_clients = [id for id, info in client_infos.items() 
                   if info['level'] == 'gold']
    # ... å…¶ä»–ç­‰çº§
    
    # 2. ä¸ºé’»çŸ³çº§åˆ›å»ºæœ€ä¼˜æ¨¡å‹
    diamond_model = aggregate_with_weights(
        client_weights,
        level_weights={'diamond': 3.0, 'gold': 2.0, 
                      'silver': 1.0, 'bronze': 0.5}
    )
    
    # 3. ä¸ºå…¶ä»–ç­‰çº§åˆ›å»ºç›¸åº”è´¨é‡çš„æ¨¡å‹
    # ...
    
    return tiered_models
```

---

## å‘½ä»¤è¡Œå‚æ•° / Command Line Arguments

### åŸºç¡€å‚æ•° / Basic Parameters

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `--dataset` | str | cifar10 | æ•°æ®é›†é€‰æ‹©ï¼šmnist, fashion-mnist, cifar10, cifar100 |
| `--num_clients` | int | 100 | å®¢æˆ·ç«¯æ€»æ•° |
| `--num_rounds` | int | 100 | è®­ç»ƒè½®æ¬¡ |
| `--clients_per_round` | int | 10 | æ¯è½®é€‰æ‹©çš„å®¢æˆ·ç«¯æ•° |

### æ¿€åŠ±æœºåˆ¶å‚æ•° / Incentive Parameters

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `--time_slice_type` | str | rounds | æ—¶é—´ç‰‡ç±»å‹ï¼šrounds, days, phases, dynamic, completion |
| `--rounds_per_slice` | int | 10 | æ¯ä¸ªæ—¶é—´ç‰‡çš„è½®æ¬¡æ•° |
| `--enable_tiered_rewards` | flag | False | å¯ç”¨å·®å¼‚åŒ–æ¨¡å‹å¥–åŠ± |
| `--tiered_strategy` | str | weighted | åˆ†å±‚ç­–ç•¥ï¼šweightedï¼ˆåŠ æƒï¼‰æˆ– strictï¼ˆä¸¥æ ¼ï¼‰|

### æ•°æ®åˆ†å¸ƒå‚æ•° / Data Distribution Parameters

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `--distribution` | str | iid | æ•°æ®åˆ†å¸ƒï¼šiidï¼ˆç‹¬ç«‹åŒåˆ†å¸ƒï¼‰æˆ– non-iid |
| `--alpha` | float | 0.5 | Non-IIDçš„Dirichletåˆ†å¸ƒå‚æ•°ï¼ˆè¶Šå°è¶Šä¸å‡è¡¡ï¼‰|

### å®éªŒå‚æ•° / Experiment Parameters

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `--experiment_name` | str | auto | å®éªŒåç§°ï¼ˆè‡ªåŠ¨ç”ŸæˆåŒ…å«æ—¶é—´æˆ³ï¼‰|
| `--num_runs` | int | 1 | å®éªŒé‡å¤æ¬¡æ•° |
| `--compare_methods` | flag | False | å¯¹æ¯”ä¸åŒæ—¶é—´ç‰‡æ–¹æ³• |
| `--compare_rewards` | flag | False | å¯¹æ¯”æ ‡å‡†vså·®å¼‚åŒ–å¥–åŠ± |
| `--seed` | int | 42 | éšæœºç§å­ |
| `--device` | str | auto | è®¡ç®—è®¾å¤‡ï¼šauto, cpu, cuda |

---

## å®Œæ•´å®éªŒå‘½ä»¤ç¤ºä¾‹ / Complete Command Examples

### å®éªŒåœºæ™¯1ï¼šåŸºç¡€å¯¹æ¯”å®éªŒ

**ç›®æ ‡**ï¼šå¯¹æ¯”æ ‡å‡†æ¿€åŠ± vs å·®å¼‚åŒ–å¥–åŠ±çš„æ•ˆæœ

```bash
# è‡ªåŠ¨è¿è¡Œä¸¤ç§æœºåˆ¶å¹¶ç”Ÿæˆå¯¹æ¯”æŠ¥å‘Š
python main.py \
    --dataset cifar10 \
    --num_clients 100 \
    --num_rounds 100 \
    --clients_per_round 10 \
    --distribution iid \
    --compare_rewards
```

**é¢„æœŸè¾“å‡º**ï¼š
```
REWARDS COMPARISON SUMMARY
======================================================================
Metric                         Standard        Differentiated  Improvement    
----------------------------------------------------------------------
Final Accuracy                 0.8542          0.8891          +4.08%
Average Accuracy               0.7923          0.8234          +3.93%
Final Loss                     0.4521          0.3892          -13.91%
Participation Rate             0.7800          0.8400          +7.69%
System Activity                0.7234          0.7891          +9.08%
Convergence Round              72              61              -15.28%

Model Quality Gap (Diamond-Bronze): 0.0847
======================================================================
```

### å®éªŒåœºæ™¯2ï¼šNon-IIDæ•°æ®åˆ†å¸ƒ

**ç›®æ ‡**ï¼šåœ¨æ›´ç°å®çš„éå‡è¡¡æ•°æ®åˆ†å¸ƒä¸‹æµ‹è¯•æœºåˆ¶

```bash
python main.py \
    --dataset cifar10 \
    --num_clients 100 \
    --num_rounds 100 \
    --distribution non-iid \
    --alpha 0.3 \
    --enable_tiered_rewards \
    --tiered_strategy weighted \
    --experiment_name noniid_tiered
```

### å®éªŒåœºæ™¯3ï¼šä¸åŒæ•°æ®é›†æµ‹è¯•

```bash
# MNISTæ•°æ®é›†ï¼ˆç®€å•ï¼‰
python main.py --dataset mnist --enable_tiered_rewards --num_rounds 50

# Fashion-MNISTæ•°æ®é›†ï¼ˆä¸­ç­‰éš¾åº¦ï¼‰
python main.py --dataset fashion-mnist --enable_tiered_rewards --num_rounds 80

# CIFAR-10æ•°æ®é›†ï¼ˆå›°éš¾ï¼‰
python main.py --dataset cifar10 --enable_tiered_rewards --num_rounds 100
```

### å®éªŒåœºæ™¯4ï¼šä¸¥æ ¼åˆ†å±‚ç­–ç•¥

**ç›®æ ‡**ï¼šæµ‹è¯•æ›´ä¸¥æ ¼çš„ç­‰çº§éš”ç¦»æ•ˆæœ

```bash
python main.py \
    --dataset cifar10 \
    --enable_tiered_rewards \
    --tiered_strategy strict \
    --experiment_name strict_strategy_test
```

### å®éªŒåœºæ™¯5ï¼šæ—¶é—´ç‰‡æ–¹æ³•å¯¹æ¯”

```bash
python main.py \
    --dataset cifar10 \
    --enable_tiered_rewards \
    --compare_methods
```

---

## å®éªŒç»“æœåˆ†æ / Results Analysis

### ğŸ“ˆ ç”Ÿæˆçš„å¯è§†åŒ–å›¾è¡¨

#### 1. è®­ç»ƒæ›²çº¿å›¾ (training_curves.png)
- **å‡†ç¡®ç‡æ›²çº¿**ï¼šå±•ç¤ºå…¨å±€æ¨¡å‹å‡†ç¡®ç‡éšè½®æ¬¡çš„å˜åŒ–
- **æŸå¤±æ›²çº¿**ï¼šè®­ç»ƒæŸå¤±çš„æ”¶æ•›è¿‡ç¨‹
- **å‚ä¸ç‡æ›²çº¿**ï¼šå®¢æˆ·ç«¯å‚ä¸ç‡çš„æ¼”å˜
- **ç³»ç»Ÿæ´»è·ƒåº¦æ›²çº¿**ï¼šæ•´ä½“ç³»ç»Ÿå¥åº·åº¦æŒ‡æ ‡

#### 2. ç­‰çº§åˆ†å¸ƒå›¾ (level_distribution.png)
- **å †å é¢ç§¯å›¾**ï¼šå±•ç¤ºå„ç­‰çº§å®¢æˆ·ç«¯æ•°é‡éšæ—¶é—´çš„æ¼”å˜
- **é¢œè‰²ç¼–ç **ï¼š
  - ğŸŸ¤ é“œçº§ (Bronze)
  - âšª é“¶çº§ (Silver)
  - ğŸŸ¡ é‡‘çº§ (Gold)
  - ğŸ”µ é’»çŸ³çº§ (Diamond)

#### 3. ç§¯åˆ†åˆ†å¸ƒå›¾ (points_distribution.png)
- **ç›´æ–¹å›¾**ï¼šå®¢æˆ·ç«¯ç§¯åˆ†çš„åˆ†å¸ƒæƒ…å†µ
- **ç®±çº¿å›¾**ï¼šè¯†åˆ«å¼‚å¸¸å€¼å’Œåˆ†å¸ƒç‰¹å¾

#### 4. æ€»ç»“æŠ¥å‘Š (summary_report.png)
- æœ€ç»ˆæ€§èƒ½æŒ‡æ ‡å¯¹æ¯”
- æ”¶æ•›é€Ÿåº¦ä¿¡æ¯
- è¯¦ç»†ç»Ÿè®¡è¡¨æ ¼

### ğŸ“Š ç»“æœJSONæ–‡ä»¶ç»“æ„

```json
{
  "experiment_name": "FL_cifar10_tiered_rounds_20241006_143022",
  "config": {
    "dataset": "cifar10",
    "num_clients": 100,
    "num_rounds": 100,
    "enable_tiered_rewards": true
  },
  "final_accuracy_mean": 0.8891,
  "final_accuracy_std": 0.0023,
  "final_loss": 0.3892,
  "avg_participation_rate": 0.8400,
  "avg_system_activity": 0.7891,
  "convergence_round":